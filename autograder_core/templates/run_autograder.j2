#!/bin/bash

# Auto-generated autograder script for Gradescope.
# Generated by TIF Autograder CLI Tool.

set -e  # Exit on any error


echo "Starting autograder..."

echo "Copying required submission files to source directory..."

# Copy only necessary files from submission to source
if [ -d "/autograder/submission" ]; then
    cd /autograder/submission
    
    # Copy each required file
    {% for file in config.files_necessary %}
    if [ -f "{{ file }}" ]; then
        echo "Copying {{ file }}..."
        # Create directory structure if needed
        mkdir -p "/autograder/source/$(dirname "{{ file }}")"
        cp "{{ file }}" "/autograder/source/{{ file }}"
    else
        echo "Warning: Required file {{ file }} not found in submission"
    fi
    {% endfor %}
    
    echo "Files copied to source directory:"
    ls -la /autograder/source/
else
    echo "Warning: Submission directory not found"
    exit 1
fi

# Change to source directory
cd /autograder/source

# Run the test runner with timeout
echo "Running tests..."
python3 run_tests.py




echo "Autograder completed successfully"
